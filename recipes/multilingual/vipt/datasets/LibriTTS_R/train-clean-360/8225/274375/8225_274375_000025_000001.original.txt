On both sides the battle was fought with desperate valor and a steady bravery.